<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Confidentiality Warning</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <style>
        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background-color: #ffffff; /* Clean white background */
            color: #323130;
            text-align: center;
            padding: 20px 25px;
            margin: 0;
            box-sizing: border-box;
        }
        h2 {
            color: #D13438; /* Microsoft Error Red */
            font-size: 18px;
            font-weight: 600;
            margin-top: 0;
            margin-bottom: 15px;
        }
        p {
            font-size: 13px;
            margin-bottom: 15px;
            color: #323130;
        }
        
        /* Light gray box for the emails */
        .email-list-container {
            background-color: #F3F2F1;
            border: 1px solid #E1DFDD;
            border-radius: 4px;
            padding: 10px 15px;
            text-align: left;
            margin-bottom: 20px;
            max-height: 120px;
            overflow-y: auto;
        }
        .email-list-container ul {
            padding-left: 20px;
            margin: 0;
            list-style-type: disc;
        }
        /* Red bullets and red text */
        .email-list-container li {
            color: #D13438;
            font-size: 13px;
            font-weight: 600;
            padding-bottom: 4px;
        }

        .confirmation-text {
            font-size: 13px;
            margin-bottom: 20px;
        }

        /* Stacked Buttons */
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        button {
            padding: 10px 15px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Solid Blue Cancel Button */
        .btn-primary {
            background-color: #0078D4;
            color: #ffffff;
            border: none;
        }
        .btn-primary:hover {
            background-color: #005A9E;
        }
        
        /* White Outline Send Button */
        .btn-secondary {
            background-color: #ffffff;
            color: #323130;
            border: 1px solid #8A8886;
        }
        .btn-secondary:hover {
            background-color: #F3F2F1;
        }
    </style>
</head>
<body>

    <h2>Confidentiality Warning</h2>
    
    <p id="dynamicText">You are sending this email to * recipient outside:</p>
    
    <div class="email-list-container">
        <ul id="extList">
            </ul>
    </div>
    
    <p class="confirmation-text">Are you sure you want to send this email?</p>

    <div class="button-group">
        <button id="cancelBtn" class="btn-primary">No, Cancel Send</button>
        <button id="sendBtn" class="btn-secondary">Yes, Send Anyway</button>
    </div>

    <script>
        Office.onReady(function() {
            var urlParams = new URLSearchParams(window.location.search);
            var extString = urlParams.get('ext');
            
            if (extString) {
                var emails = extString.split(',');
                var listHtml = "";
                for (var i = 0; i < emails.length; i++) {
                    // Inject the emails as list items
                    listHtml += "<li>" + emails[i].trim() + "</li>";
                }
                document.getElementById("extList").innerHTML = listHtml;
                
                // Dynamically update the count (1 recipient vs 2 recipients)
                var recWord = emails.length === 1 ? "recipient" : "recipients";
                document.getElementById("dynamicText").innerText = "You are sending this email to " + emails.length + " " + recWord + " outside:";
            } else {
                document.getElementById("extList").innerHTML = "<li>External recipients found</li>";
                document.getElementById("dynamicText").innerText = "You are sending this email to recipients outside:";
            }

            // Bind the buttons to the Outlook actions
            document.getElementById("cancelBtn").onclick = function() { Office.context.ui.messageParent("cancel"); };
            document.getElementById("sendBtn").onclick = function() { Office.context.ui.messageParent("allow"); };
        });
    </script>
</body>
</html>
