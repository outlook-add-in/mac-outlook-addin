<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Confidentiality Warning</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <style>
        body { 
            font-family: "Segoe UI", sans-serif; 
            background-color: #FFFFFF; /* Pure white background */
            color: #000000; /* Pure black text */
            text-align: center; 
            padding: 20px; 
        }
        h1 { 
            font-size: 20px; 
            margin-top: 0; 
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }
        p { 
            font-size: 14px; 
            margin-bottom: 20px; 
        }
        
        /* Box to show the list of emails */
        .email-list { 
            background: #FFFFFF; 
            border: 1px solid #000000; 
            padding: 10px; 
            max-height: 100px; 
            overflow-y: auto; 
            text-align: left;
            font-size: 13px; 
            font-weight: bold; 
            margin-bottom: 20px;
        }
        ul { margin: 0; padding-left: 20px; }
        
        /* Stack buttons */
        .btn-group { display: flex; flex-direction: column; gap: 10px; }
        .btn { 
            padding: 12px 15px; 
            font-size: 14px; 
            cursor: pointer; 
            width: 100%; 
            font-weight: bold; 
        }
        
        /* Black and White Buttons */
        .btn-send { 
            background-color: #FFFFFF; 
            color: #000000; 
            border: 2px solid #000000;
        }
        .btn-cancel { 
            background-color: #000000; 
            color: #FFFFFF; 
            border: 2px solid #000000;
        }
        .btn:hover { opacity: 0.7; }
    </style>
</head>
<body>
    <h1>Confidentiality Warning</h1>
    
    <p id="dynamicText">You are sending this email to * recipient outside:</p>
    
    <div class="email-list">
        <ul id="extList">
            </ul>
    </div>
    
    <p>Are you sure you want to send this email?</p>

    <div class="btn-group">
        <button id="cancelBtn" class="btn btn-cancel">No, Cancel</button>
        <button id="sendBtn" class="btn btn-send">Yes, Send Anyway</button>
    </div>

    <script>
        Office.onReady(function() {
            // Get emails from the URL
            var urlParams = new URLSearchParams(window.location.search);
            var extString = urlParams.get('ext');
            
            // List the emails in the box and update the text
            if (extString) {
                var emails = extString.split(',');
                var listHtml = "";
                for (var i = 0; i < emails.length; i++) {
                    listHtml += "<li>" + emails[i] + "</li>";
                }
                document.getElementById("extList").innerHTML = listHtml;
                
                // Dynamically replace the "*" with the actual number of recipients
                var recWord = emails.length === 1 ? "recipient" : "recipients";
                document.getElementById("dynamicText").innerText = "You are sending this email to " + emails.length + " " + recWord + " outside:";
                
            } else {
                document.getElementById("extList").innerHTML = "<li>External recipients found</li>";
                document.getElementById("dynamicText").innerText = "You are sending this email to recipients outside:";
            }

            // Button Logic: Allow or Cancel
            document.getElementById("sendBtn").onclick = function() { Office.context.ui.messageParent("allow"); };
            document.getElementById("cancelBtn").onclick = function() { Office.context.ui.messageParent("cancel"); };
        });
    </script>
</body>
</html>
